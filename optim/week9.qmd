---
title: "Week 9: Linear programming"
---

In the following exercises you will learn the basics of Pyomo. Setting up a simple problem is relatively straightforward, but adding extra variables/constraints quickly becomes problematic if you don't learn how to use its more advanced functionality.

These exercises will take you through setting up a basic problem with simple notation before moving to the more advanced functionality on the same problem. Finally, we will tackle a significantly larger problem requiring importing data.

## Supplementary material

- Algorithms for Optimisation - [Linear constrained optimization](https://algorithmsbook.com/optimization/files/chapter-11.pdf)
- [Pyomo Workshop Slides](https://github.com/Pyomo/pyomo-tutorials/raw/main/Pyomo-Workshop-December-2023.pdf) - slide 25 onwards in particular
- Various linear programming implementations
  - Python - [Pyomo](https://www.pyomo.org/)
  - Julia - [JuMP](https://jump.dev/JuMP.jl/stable/)
  - MATLAB - [Optimization Toolbox](https://uk.mathworks.com/help/optim/)

## Exercise 1 - a simple diet problem

The backdrop to this exercise is <https://www.youtube.com/watch?v=36Uj1ZhWqa8>; there is no need to watch the video unless you would like a reminder of how linear programming works.

In this exercise, a company would like to minimise the cost of "healthy" side dishes for their burgers. They have three basic ingredients: carrot, white cabbage, and pickled cucumbers.

The costs (per kg) of each of these ingredients are

| Ingredient | Cost |
|------------|-----:|
| Carrot     | 0.75 |
| Cabbage    | 0.50 |
| Cucumber   | 0.15 |

Their nutritional contents, with requirements per side dish, are

| Nutrition            | Carrot | Cabbage | Cucumber | Requirement |
|----------------------|-------:|--------:|---------:|------------:|
| Vitamin A (mg/kg)    | 35     | 0.5     |      0.5 | 0.5mg       |
| Vitamin B (mg/kg)    | 60     | 300     |      10  | 15mg        |
| Dietary Fibre (g/kg) | 30     | 20      |      10  | 4g          |

1. Create a model object to hold the problem. E.g., `pyo.ConcreteModel()`.
2. Create variables corresponding to each ingredient. E.g., `pyo.Var(within=pyo.NonNegativeReals)`.
3. Create an objective function to minimise the total cost. E.g., `pyo.Objective(expr=..., sense=pyo.minimize)`.
4. Create constraints for each of the nutritional requirements. E.g., `pyo.Constraint(expr=...)`.
5. Solve the linear program. E.g., `solver = pyo.SolverFactory('glpk') ; results = solver.solve(model, tee=True) ; model.pprint()`. Does the solution match that of the YouTube video (carrot = 9.5g, cabbage = 38g, cucumber = 294g)?
6. Let's suppose that cucumbers aren't available. There are a couple of ways we could achieve this - for example, we could rebuild with the third column removed. Alternatively, we could add an equality constraint on the problem (cucumber = 0).

## Exercise 2 - a simple diet problem extended

The goal with this exercise is to simplify the construction of the objective function and the constraints. Often data is provided in tableaus (as above) and instead of manually typing out constraints, we can use loops over the rows/columns of the table. This may not seem simpler for this small example, but it will be significantly easier for large problems.

1. Read slides 28-30 of the Pyomo Workshop Slides (link above; "Simple Modeling Example: Classic Knapsack Problem" onwards). How might you create a similar structure for the diet problem?
2. Use the variables (carrot, cabbage, cucumber) as the indices, with the cost and nutritional content as dictionaries (e.g., `cost = {'carrot': 0.75, ...}` and `vitaminA = {'carrot': 35}`). Create the full problem in Pyomo, solve it, and check your answer matches with exercise 1.
3. Using dictionaries, it was possible to simplify the problem so we have a single variable (with indices `['carrot', 'cabbage', 'cucumber']`), but all the constraints are still defined separately. To store all the constraint information in a single table, we can create a dictionary of the form `nutrition = {('carrot', 'vitamin A'): 35, ('carrot', 'vitamin B'): 60, ..., ('cucumber', 'fibre'): 10}`. Create a dictionary for the nutrition and a separate dictionary for the requirements.
4. Rather than give names to individual constraints, it is possible to create a list of constraints in Pyomo. This enables us to use loops to create many constraints easily. The form of the command is

   ```python
   model.constraints = pyo.ConstraintList()
   for n in nutrient_names:
      model.constraints.add(...)
   ```

   How can you use this form to condense the creation of all the constraints? Solve the problem and check that your results match your previous results.
   - Creating a dictionary by hand in this way is quite painful. We'd usually load one in from a spreadsheet directly - see the next exercise.

## Exercise 3 - a bigger diet problem

