\documentclass[11pt, a4paper]{article}

\usepackage{fullpage}
\usepackage{amsmath}

\renewcommand{\vec}[1]{\boldsymbol{#1}}
\newcommand{\tens}[1]{\mathbf{#1}}
\newcommand{\td}[2]{\frac{\mathrm{d} #1}{\mathrm{d}#2}}
\newcommand{\tdd}[2]{\frac{\mathrm{d}^2 #1}{\mathrm{d}#2^2}}
\newcommand{\pd}[2]{\frac{\partial #1}{\partial#2}}
\newcommand{\pdd}[2]{\frac{\partial^2 #1}{\partial#2^2}}



% subequation environment
\newenvironment{subeq}[1]{
\begin{subequations}
#1
\end{subequations}
}



%======================================================

\begin{document}

\begin{center}
\textbf{Scientific Computing and Optimisation} \\
Solutions of the diffusion equation\\
Matthew Hennessy
\end{center}

\paragraph{Separation of variables:}
There are many ways to solve the diffusion equation. The technique that
you are probably most familiar with is separation of variables, which
leads to a solution in the form of a Fourier series.  Separation
of variables is, however, relatively limited in scope and usually
requires a few steps to be carried out 
before it can be applied to a ``real'' problem.
For instance, consider the problem
\subeq{\label{eqn:1}
\begin{align}
\pd{u}{t} = D \pdd{u}{x} + q(x)
\end{align}
with boundary and initial conditions
\begin{align}
u(a,t) = \alpha, \quad u(b,t) = \beta, \quad u(x,0) = f(x).
\end{align}}
Due to the inhomogeneous boundary conditions and the source term,
separation of variables cannot immediately be applied.  To get
around this, we first look for a steady-state solution by writing
$u(x,t) = v(x)$.  The problem for $v(x)$ is given by
\begin{align}
D \tdd{v}{x} + q(x) = 0,
\end{align}
with boundary conditions $v(a) = \alpha$ and $v(b) = \beta$.  
This is an ODE that can be solved, at least in theory. 
For example, if $q(x) = 1$, then 
\begin{align}
v(x) = -\frac{1}{2D}(x-a)(x-b) + \left(\frac{\beta - \alpha}{b-a}\right)(x - a) + \alpha.
\end{align}
Once $v$ is known, the solution to the PDE is written as
$u(x,t) = v(x) + U(x,t)$.  The problem for $U$ is then given by
\begin{align}
\pd{U}{t} = D \pdd{U}{x},
\end{align}
with 
\begin{align}
U(a,t) = 0, \quad U(b,t) = 0, \quad U(x,0) = f(x) - v(x).
\end{align}
Notice that there is no source term in the PDE nor are there any inhomogeneous
contributions to the boundary conditions; these have been accounted for
in the solution for $v$.  The problem for $U$ is in a form that is suitable
for the separation of variables to be applied.  After doing so, we find that
\begin{align}
U(x,t) = \sum_{n=1}^{\infty} B_n \exp\left(-\frac{n^2 \pi^2 D t}{(b-a)^2}\right)
\sin\left(\frac{n \pi (x - a)}{b-a}\right),
\end{align}
where the Fourier coefficients $B_n$ are given by
\begin{align}
B_n = \frac{2}{b-a} \int_{a}^{b} [f(x) - v(x)] \sin \left(\frac{n \pi (x - a)}{b - a}\right)\, \mathrm{d} x.
\label{eqn:bn}
\end{align}
Although this solution holds for any $\alpha$, $\beta$, $q(x)$, and $f(x)$, there are a
few special cases to consider.

If $\alpha = \beta = 0$ and $q(x) = 0$, then $v(x) = 0$.  Choosing an initial condition
of the form
\begin{align}
f(x) = \sin\left(\frac{m \pi (x - a)}{b - a}\right),
\end{align}
where $m$ is an integer, 
means that the integrals in \eqref{eqn:bn} evaluate to
$B_{m} = 1$ and $B_{n\neq m} = 0$.
Hence, the solution to the original PDE \eqref{eqn:1} is 
\begin{align}
u(x,t) = \exp\left(-\frac{m^2 \pi^2 D t}{(b-a)^2}\right)
\sin\left(\frac{m \pi (x - a)}{b-a}\right).
\label{eqn:u_sol}
\end{align}

Similarly, if $\alpha = \beta = 0$, $f(x) = 0$, and
\begin{align}
q(x) = -\frac{m^2 \pi^2 D}{(b - a)^2}\sin\left(\frac{m \pi (x - a)}{b-a}\right),
\end{align}
where $m$ is again an integer,
then the solution for $v(x)$ is given by
\begin{align}
v(x) = -\sin\left(\frac{m \pi (x - a)}{b-a}\right).
\end{align}
Evaluating the integrals again leads to $B_m = 1$ and $B_{n \neq m} = 0$;
hence the solution for $u(x,t)$ in this case is given by
\begin{align}
u(x,t) = \left[\exp\left(-\frac{m^2 \pi^2 D t}{(b-a)^2}\right) - 1\right]
\sin\left(\frac{m \pi (x - a)}{b-a}\right).
\label{eqn:u_sol2}
\end{align}

Finally, we consider the case when $\alpha = 1$, $\beta = 0$,
$q(x) = 0$, and $f(x) = 0$. We find that $v(x) = 1 - (x-a)/(b-a)$
and the Fourier coefficients are $B_n = -2 / (n \pi)$.
Hence, the solution to the original PDE is
\begin{align}
  u(x,t) = 1 - \frac{x-a}{b-a} - \frac{2}{\pi} \sum_{n=1}^{\infty}
  \frac{1}{n} \exp\left(-\frac{n^2 \pi^2 D t}{(b-a)^2}\right)
  \sin\left(\frac{n \pi (x - a)}{b-a}\right).
  \label{eqn:u_sol_3}
\end{align}

The same approach can be applied with other types of boundary
conditions as well.


\paragraph{Similarity solutions:} Similarity solutions are a special type of solution
in which the two independent variables, in this case $x$ and $t$, always appear
together as the same product $\eta$; for example, $\eta = x / t^{1/2}$.  What this means is that
the solution of the PDE, $u(x,t)$, can be represented as a function of a single
variable, $f(\eta)$.  This allows the PDE to be reduced to an ODE.  
Similarity solutions are incredibly powerful as they can be applied to a wide range of
problems and they often produce the most
physically meaningful and useful solutions. The caveat is that
similarity solutions can usually only be found when the domain of the
problem is infinite or semi-infinite. However, there are often
limits in which it is appropriate to approximate a finite domain with
an infinite one; in this case, similarity solutions can be sought.

As an example, consider the problem
\begin{align}
  \pd{u}{t} = D \pdd{u}{x}
\end{align}
with $u(0,t) = 1$, $u(1,t) = 0$, and $u(x,0) = 0$. This problem was solved
above using the separation of variables. The solution is given by
\eqref{eqn:u_sol_3},
which is not very easy to interpret. However, we can find an
approximate solution, in the form of a similarity solution, that is
valid for small times. As motivation, we notice that there is an incompatibility
between the initial condition, $u(x,0) = 0$, and the left boundary condition,
$u(0,t) = 1$. As a result, we expect that for very small times, the
solution away from the boundary at $x = 0$
will remain close to zero (due to the
initial condition). However, near the $x = 0$ boundary, the solution will
rapidly increase to one to satisfy the boundary condition. Therefore,
all of the action is happening near $x = 0$ for small times so we can
replace the finite domain $0 \leq x \leq 1$ with a semi-infinite domain
$0 \leq x < \infty$.

The new problem to consider is then
\begin{align}
  \pd{u}{t} = D \pdd{u}{x}
\end{align}
with $u(0,t) = 1$, $u(\infty,t) = 0$, and $u(x,0) = 0$.
We now look for a solution of the form $u(x,t) = f(x/t^{1/2}) = f(\eta)$
where $\eta = x /  t^{1/2}$. We then have that
\begin{align}
  \pd{u}{t} = -\frac{1}{2} x t^{-3/2} f'(\eta) = -\frac{1}{2} \eta t^{-1}
  f'(\eta),
  \qquad
  \pdd{u}{x} = t^{-1} f''(\eta).
\end{align}
The diffusion equation then becomes a second-order ODE given by
\begin{align}
  -\frac{1}{2} \eta f'(\eta) = D f''(\eta).
  \label{eqn:f}
\end{align}
The boundary conditions for $f$ are determined from the boundary and
initial conditions for $u$ and read as
$f(0) = 1$ and $f(\infty) = 0$. The solution for $f$ is given by
\begin{align}
  f(\eta) = 1 - \frac{2}{\pi^{1/2}} \int_{0}^{\eta / (4D)^{1/2} } e^{-s^2}\,ds =
  1 - \mathrm{erf}\left(\frac{\eta}{(4D)^{1/2}}\right),
\end{align}
where $\mathrm{erf}(\eta)$ is called the error function. The solution
to the PDE is therefore given by
\begin{align}
  u(x,t) = 1 - \mathrm{erf}\left(\frac{x}{(4Dt)^{1/2}}\right).
\end{align}
This expressions tells us that the solution $u$ has a self-similar
profile; that is, the solutions at different points in time are simply
horizontally stretched versions of the same curve.

You might wonder why this method works and how we knew to look for
a solution of the form $u(x,t) = f(x / t^{1/2})$. There is a mathematically
elegant theory for when similarity solutions arise; in summary, they occur when the
PDE and boundary conditions have an underlying symmetry or invariance.  However,
these properties can be hard to spot and,
as a result, one usually does not know right away if a similarity solution exists.
One way to
find them is to simply assume they do exist and then to look for a solution
of the form $u(x,t) = f(x/t^p)$, where the exponent $p$ is found by
eliminating all of the time dependences from the ODE and boundary conditions
for $f$.
Notice that $t$ does not appear in the ODE given by \eqref{eqn:f} nor in
any of the associated boundary conditions for $f$. If $t$ did appear,
then that would mean the solution for $f$ depends on both $\eta$
and $t$, contradicting the assumption that $f$ is solely a function of $\eta$.
Sometimes, one is required to
look for similarity solutions of the form $u(x,t) = t^r f(x/t^{p})$.
For example, the problem
\subeq{
\begin{align}
  \pd{u}{t} = D \pdd{u}{x}
\end{align}
with
\begin{align}
  D \left.\pd{u}{x}\right|_{x=0} = -j, \quad u(\infty,0) = 0, \quad u(x,0) = 0
\end{align}}
has a similarity solution of the form $u(x,t) = t^{1/2} f(x/t^{1/2})$,
where
\begin{align}
  f(\eta) = \frac{j}{D}\left[\eta\, \mathrm{erf}\left(\frac{\eta}{(4 D)^{1/2}}\right) - \eta + \left(\frac{4 D}{\pi}\right)^{1/2}\exp\left(-\frac{\eta^2}{4 D}\right)\right].
\end{align}
The similarity solution tells us that the solution $u$ at the boundary $x=0$ evolves in
time as
\begin{align}
u(0,t) = j \left(\frac{4 t}{\pi D}\right)^{1/2}.
\end{align}
  
\end{document}